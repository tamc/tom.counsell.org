<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Morphological analysis script</title>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="screen">
		@import url( ../Static/style.css );
	</style>
	<link rel='alternate' type='application/rss+xml' title='RSS' href='http://tom.counsell.org/rss/MorphologicalAnalysisScript' />
	<script src='http://tom.counsell.org/Static/newpage.js' type='text/javascript'></script>
		
</head>

<body onkeypress='hotkey(event,"http://tom.counsell.org/edit/");'>
<div id="wrapper">
	<div id="masthead">
		<div id="blogtitle" >
			Morphological analysis script
		</div>
	</div>
	
	<div id="insideWrapper">
	
		<div id="sidebar">
			<div id="sidebox">
				<div class="title"><a href="../index.html" title="Tom Counsell's Soks Wiki">Tom Counsell's Soks Wiki</a></div>
			</div>
			<br />
	
			<div id="sidebox1">
				<div class="title">Key Pages</div>
				
				<a href='../index.html' class='automatic'>Home Page</a> <br/>
<a href='../view/SiteIndex.html' class='automatic'>Site Index</a> <br/>
<a href='../view/RecentChangesToThisSite.html' class=''>Recent Changes</a> <br/>
			</div>
			<br />

			<div id="sidebox4">
				<form style="padding: 0px; margin-top: 0px; margin-bottom: 0px;" id="searchform" method="get" action="http://tom.counsell.org/find/MorphologicalAnalysisScript">
					<div class="title">Search:</div>
					<p style="padding: 0px; margin-top: 0px; margin-bottom: 0px;">
						<input type="text" class="input" name="regex" id="search" size="15" />
						<input name="submit" type="submit" tabindex="5" value="GO" />
					</p>
				</form>
			</div>
			<br />
			
			<div id='adbox'>
				<div class='title'>Adverts</div>
				<script type="text/javascript"><!--
				google_ad_client = "pub-1825629230893907";
				google_ad_width = 120;
				google_ad_height = 90;
				google_ad_format = "120x90_0ads_al";
				google_ad_channel = "";
				google_color_border = "000000";
				google_color_bg = "000000";
				google_color_link = "FFFFFF";
				google_color_text = "CCCCCC";
				google_color_url = "999999";
				//-->
				</script>
				<script type="text/javascript"
				  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
				  </script>
<p>
</p>
			</div>
<br/>			
			<div id="sidebox2">
				<div class="title">Backlinks</div>
				
					
					
					
				
			</div>
			<br />
	
			<div id="sidebox3">
				<div class="title">Other Pages</div>
				<a href='../view/History.html' class='automatic'>History</a> <br/>
<a href='../view/Phd.html' class='automatic'>PhD</a> <br/>
<a href='../view/StuffIDoAroundTheDepartment.html' class=''>Department work</a> <br/>
<a href='../view/CollegeWork.html' class='automatic'>College work</a> <br/>
<a href='../view/Programming.html' class='automatic'>Programming</a> <br/>
			</div>
			<br />
			

	
			<div id="sidebox5">
				<div class="title">Links</div>
				<a href='http://tom.counsell.org/edit/TypeATitleHere'>Add a new page</a><br/>
				<a href='http://tom.counsell.org/edit/PictureOfTypeATitleHere'>Upload a new picture</a><br/>
				<a href='http://tom.counsell.org/edit/AttachedTypeATitleHere'>Upload a new file</a><br/>
			</div>
			<br />
	
			<div id="sidebox6">
				<div class="title"><a href='http://www.soks.org'>Soks</a> Powered</div>
				<a href='http://www.soks.org'>Soks</a> is a wiki written in ruby
			</div>  
			<br />
	</div>
	
	<div id="contentwrapper">
		<div id="content">
			<br />
			<div class="post">
			<span class='pagename'><a href='http://tom.counsell.org/meta/MorphologicalAnalysisScript'>Morphological analysis script</a> </span>






	<div class="undochange">
		<p>Mon Aug 08 08:02:44 -0400 2005 by <a href='../view/Tamc.html'>tamc</a></p>
		<ol>	
		
				
						<li><del>2. Zwicky proposed an approach to problem solving (described [[here (pdf) =&gt; http://www.swemorph.com/pdf/new-methods.pdf]]) that is rather tedious to do by hand.  The script below helps. It requires ruby 1.8+.</del></li>
					
				
						<li>2. Zwicky proposed an approach to problem solving (described [[in this pdf =&gt; http://www.swemorph.com/pdf/new-methods.pdf]]) that is rather tedious to do by hand.  The script below helps. It requires ruby 1.8+.  If you want to know more about Morphological Analysis, take a look at the Swedish Morphological Society's site at www.swemorph.com</li>
					
				
					
		</ol>
		<form method=post action='http://tom.counsell.org/rollback/MorphologicalAnalysisScript' >
			<input name='revision' value='2' type='hidden' />
			<input name='action' value='Undo the changes above' type='submit' />
		</form>
	</div>		

	<div class="undochange">
		<p>Thu Jul 28 06:16:15 -0400 2005 by <a href='../view/Tamc.html'>tamc</a></p>
		<ol>	
		
				
						<li>4. &lt;pre&gt;</li>
					
				
		
				
						<li>201. &lt;/pre&gt;</li>
					
				
					
		</ol>
		<form method=post action='http://tom.counsell.org/rollback/MorphologicalAnalysisScript' >
			<input name='revision' value='1' type='hidden' />
			<input name='action' value='Undo the changes above' type='submit' />
		</form>
	</div>		

	<div class="undochange">
		<p>Thu Jul 28 06:16:04 -0400 2005 by <a href='../view/Tamc.html'>tamc</a></p>
		<ol>	
		
				
						<li><del>4. &lt;pre&gt;</del></li>
					
				
		
				
						<li><del>201. &lt;/pre&gt;</del></li>
					
				
					
		</ol>
		<form method=post action='http://tom.counsell.org/rollback/MorphologicalAnalysisScript' >
			<input name='revision' value='0' type='hidden' />
			<input name='action' value='Undo the changes above' type='submit' />
		</form>
	</div>		

	<div class="undochange">
		<p>Thu Jul 28 06:14:15 -0400 2005 by <a href='../view/Tamc.html'>tamc</a></p>
		<ol>	
		
				
						<li>0. h1. Morphological (combinatorial) analysis script</li>
					
				
						<li>1. </li>
					
				
						<li>2. Zwicky proposed an approach to problem solving (described [[here (pdf) =&gt; http://www.swemorph.com/pdf/new-methods.pdf]]) that is rather tedious to do by hand.  The script below helps. It requires ruby 1.8+.</li>
					
				
						<li>3. </li>
					
				
						<li>4. &lt;pre&gt;</li>
					
				
						<li>5. &lt;code&gt;</li>
					
				
						<li>6. #!/usr/bin/ruby</li>
					
				
						<li>7. # File name: zwicky.rb</li>
					
				
						<li>8. # (c) 2005 Tom Counsell tom@counsell.org</li>
					
				
						<li>9. # Licenced under the GPL</li>
					
				
						<li>10. #</li>
					
				
						<li>11. # Helps with Zwicky's morphological analysis</li>
					
				
						<li>12. # See http://www.swemorph.com/pdf/new-methods.pdf for details of that.</li>
					
				
						<li>13. #</li>
					
				
						<li>14. # Requires ruby 1.8</li>
					
				
						<li>15. #</li>
					
				
						<li>16. # To use: ruby zwicky.rb parameterfile constraintfile</li>
					
				
						<li>17. #</li>
					
				
						<li>18. # The parameterfile is a YAML text file formated like this:</li>
					
				
						<li>19. # Order:</li>
					
				
						<li>20. # - Reflect</li>
					
				
						<li>21. # - Add reflector</li>
					
				
						<li>22. # - Pigment</li>
					
				
						<li>23. # - Polymer</li>
					
				
						<li>24. # - Paper surface</li>
					
				
						<li>25. # </li>
					
				
						<li>26. # Reflect:</li>
					
				
						<li>27. #  - Off air</li>
					
				
						<li>28. #  - Off polymer</li>
					
				
						<li>29. #  - Off pigment</li>
					
				
						<li>30. #  - Off paper top</li>
					
				
						<li>31. #  - Off paper bulk</li>
					
				
						<li>32. #</li>
					
				
						<li>33. # The constraint file is optional.  </li>
					
				
						<li>34. # It lists incompatible states.</li>
					
				
						<li>35. # It is a YAML text file formated like this:</li>
					
				
						<li>36. # Off air:</li>
					
				
						<li>37. #  - No addition</li>
					
				
						<li>38. #  - Above pigment</li>
					
				
						<li>39. #  - Above paper top</li>
					
				
						<li>40. #  - Above paper bulk</li>
					
				
						<li>41. # </li>
					
				
						<li>42. # Off polymer:</li>
					
				
						<li>43. #  - Above polymer</li>
					
				
						<li>44. #  - Remove polymer</li>
					
				
						<li>45. #  - Remove paper</li>
					
				
						<li>46. #  - Above paper top</li>
					
				
						<li>47. #   </li>
					
				
						<li>48. # Let me know of any bugfixes or suggestions</li>
					
				
						<li>49. require 'yaml'</li>
					
				
						<li>50. </li>
					
				
						<li>51. class Parameter</li>
					
				
						<li>52. 	</li>
					
				
						<li>53. 	attr_reader :previous_parameter, :name, :states</li>
					
				
						<li>54. 	</li>
					
				
						<li>55. 	def initialize( previous_parameter, name, states )</li>
					
				
						<li>56. 		@name, @states = name, states</li>
					
				
						<li>57. 		@previous_parameter = previous_parameter</li>
					
				
						<li>58. 		@current_state = 0</li>
					
				
						<li>59. 	end</li>
					
				
						<li>60. 	</li>
					
				
						<li>61. 	def state</li>
					
				
						<li>62. 		states[ @current_state ]</li>
					
				
						<li>63. 	end</li>
					
				
						<li>64. 	</li>
					
				
						<li>65. 	def next_state</li>
					
				
						<li>66. 		@current_state += 1</li>
					
				
						<li>67. 		if @current_state &gt;= states.size</li>
					
				
						<li>68. 			return :end_of_sequence if previous_parameter == :no_previous_parameter</li>
					
				
						<li>69. 			@current_state = 0</li>
					
				
						<li>70. 			previous_parameter.next_state </li>
					
				
						<li>71. 		end</li>
					
				
						<li>72. 	end</li>
					
				
						<li>73. end</li>
					
				
						<li>74. </li>
					
				
						<li>75. class Problem</li>
					
				
						<li>76. 	include Enumerable</li>
					
				
						<li>77. 	</li>
					
				
						<li>78. 	attr_reader :parameters, :constraints</li>
					
				
						<li>79. </li>
					
				
						<li>80. 	def initialize( parameters, constraints, order )</li>
					
				
						<li>81. 		@parameters = []</li>
					
				
						<li>82. 		@constraints = constraints</li>
					
				
						<li>83. 		fully_constrain</li>
					
				
						<li>84. 		previous_parameter = :no_previous_parameter</li>
					
				
						<li>85. 		order.each do |name|</li>
					
				
						<li>86. 			states = parameters[ name ]</li>
					
				
						<li>87. 			@parameters &lt;&lt; (previous_parameter = Parameter.new(previous_parameter,name,states))</li>
					
				
						<li>88. 		end</li>
					
				
						<li>89. 	end</li>
					
				
						<li>90. 	</li>
					
				
						<li>91. 	def names</li>
					
				
						<li>92. 		parameters.map { |parameter| parameter.name }</li>
					
				
						<li>93. 	end</li>
					
				
						<li>94. 	</li>
					
				
						<li>95. 	def solution</li>
					
				
						<li>96. 		parameters.map { |parameter| parameter.state }</li>
					
				
						<li>97. 	end</li>
					
				
						<li>98. 	</li>
					
				
						<li>99. 	def number_of_solutions</li>
					
				
						<li>100. 		parameters.inject(1) { |total,parameter| total = total * parameter.states.size }</li>
					
				
						<li>101. 	end</li>
					
				
						<li>102. 	</li>
					
				
						<li>103. 	def next_solution</li>
					
				
						<li>104. 		parameters.last.next_state</li>
					
				
						<li>105. 	end</li>
					
				
						<li>106. 	</li>
					
				
						<li>107. 	def each</li>
					
				
						<li>108. 		yield solution until next_solution == :end_of_sequence</li>
					
				
						<li>109. 	end</li>
					
				
						<li>110. 	</li>
					
				
						<li>111. 	def solution_valid?</li>
					
				
						<li>112. 		solution.each do |state|</li>
					
				
						<li>113. 			next unless @constraints.has_key?( state )</li>
					
				
						<li>114. 			return false unless (@constraints[ state ] & solution).size == 0</li>
					
				
						<li>115. 		end</li>
					
				
						<li>116. 		true</li>
					
				
						<li>117. 	end</li>
					
				
						<li>118. 	</li>
					
				
						<li>119. 	def fully_constrain</li>
					
				
						<li>120. 		constraints.each do |stateA,otherstates|</li>
					
				
						<li>121. 			otherstates.each do |otherstate|</li>
					
				
						<li>122. 				unless constraints[otherstate] && constraints[otherstate].include?(stateA)</li>
					
				
						<li>123. 					constraints[otherstate] ||= []</li>
					
				
						<li>124. 					constraints[otherstate] &lt;&lt; stateA</li>
					
				
						<li>125. 				end</li>
					
				
						<li>126. 			end</li>
					
				
						<li>127. 		end</li>
					
				
						<li>128. 	end</li>
					
				
						<li>129. 	</li>
					
				
						<li>130. 	def constraints_as_grid</li>
					
				
						<li>131. 		grid = []</li>
					
				
						<li>132. 		row = ['Parameter','',]</li>
					
				
						<li>133. 		parameters.each do |parameter|</li>
					
				
						<li>134. 			row &lt;&lt; parameter.name</li>
					
				
						<li>135. 			(parameter.states.size - 1).times { row &lt;&lt; '' }</li>
					
				
						<li>136. 		end</li>
					
				
						<li>137. 		grid &lt;&lt; row</li>
					
				
						<li>138. 		row = ['','States']</li>
					
				
						<li>139. 		parameters.each do |parameter|</li>
					
				
						<li>140. 			parameter.states.each do |state|</li>
					
				
						<li>141. 				row &lt;&lt; state</li>
					
				
						<li>142. 			end</li>
					
				
						<li>143. 		end</li>
					
				
						<li>144. 		grid &lt;&lt; row</li>
					
				
						<li>145. 		parameters.each do |parameterA|</li>
					
				
						<li>146. 			pname = parameterA.name</li>
					
				
						<li>147. 			parameterA.states.each do |stateA|</li>
					
				
						<li>148. 				row = [pname,stateA]</li>
					
				
						<li>149. 				pname = ''</li>
					
				
						<li>150. 				parameters.each do |parameterB|</li>
					
				
						<li>151. 					parameterB.states.each do |stateB|</li>
					
				
						<li>152. 						row &lt;&lt; (constraints[stateA].include?(stateB) ? 'x' : '')</li>
					
				
						<li>153. 					end</li>
					
				
						<li>154. 				end</li>
					
				
						<li>155. 				grid &lt;&lt; row</li>
					
				
						<li>156. 			end</li>
					
				
						<li>157. 		end</li>
					
				
						<li>158. 		grid </li>
					
				
						<li>159. 	end</li>
					
				
						<li>160. 	</li>
					
				
						<li>161. end</li>
					
				
						<li>162. </li>
					
				
						<li>163. parameters = YAML::load(IO.readlines(ARGV[0]).join)</li>
					
				
						<li>164. order = parameters['Order'] || parameters.keys</li>
					
				
						<li>165. parameters.delete('Order')</li>
					
				
						<li>166. </li>
					
				
						<li>167. constraints = ARGV[1] ? YAML::load(IO.readlines(ARGV[1]).join) : {}</li>
					
				
						<li>168. </li>
					
				
						<li>169. problem = Problem.new( parameters, constraints, order )</li>
					
				
						<li>170. </li>
					
				
						<li>171. puts "Morphological Box"</li>
					
				
						<li>172. </li>
					
				
						<li>173. problem.parameters.each do |parameter|</li>
					
				
						<li>174. 	puts "#{parameter.name}\t#{parameter.states.join("\t")}"</li>
					
				
						<li>175. end</li>
					
				
						<li>176. </li>
					
				
						<li>177. puts </li>
					
				
						<li>178. puts "Constraints"</li>
					
				
						<li>179. </li>
					
				
						<li>180. problem.constraints_as_grid.each do |row|</li>
					
				
						<li>181. 	puts row.join("\t")</li>
					
				
						<li>182. end</li>
					
				
						<li>183. </li>
					
				
						<li>184. puts</li>
					
				
						<li>185. puts "Alternatives"</li>
					
				
						<li>186. </li>
					
				
						<li>187. puts "Number\t#{problem.names.join("\t")}"</li>
					
				
						<li>188. total_valid = 0</li>
					
				
						<li>189. </li>
					
				
						<li>190. problem.each_with_index do |solution,index|</li>
					
				
						<li>191. 	if problem.solution_valid?</li>
					
				
						<li>192. 		puts "#{index+1}\t#{solution.map{ |state| state =~ /^leave/i ? "-" : state }.join("\t")}" </li>
					
				
						<li>193. 		total_valid += 1</li>
					
				
						<li>194. 	end</li>
					
				
						<li>195. end</li>
					
				
						<li>196. </li>
					
				
						<li>197. puts ""</li>
					
				
						<li>198. puts "#{problem.number_of_solutions} solutions, of which #{total_valid} valid."</li>
					
				
						<li>199. </li>
					
				
						<li>200. &lt;/code&gt;</li>
					
				
						<li>201. &lt;/pre&gt;</li>
					
				
					
		</ol>
		<form method=post action='http://tom.counsell.org/rollback/MorphologicalAnalysisScript' >
			<input name='revision' value='-1' type='hidden' />
			<input name='action' value='Undo the changes above' type='submit' />
		</form>
	</div>		



<div class='command'>
	<a href='http://tom.counsell.org/edit/MorphologicalAnalysisScript' accesskey="R" >Return to editing</a>
</div>

			<br />
		</div>
		<br />
	</div>
</div>



<div id="footer">

 <br />From an original theme on <a class="footerLink" href='http://wordpress.org' title='Proudly powered by WordPress, state-of-the-art semantic personal publishing platform'>WordPress 1.5</a>. <br />

This theme started out as <a class="footerLink" href="http://www.thoughtmechanics.com/blog/templates">Benevolence</a><br /> and ended up as  <a class="footerLink" href="http://theloo.org/2005/03/06/borderline-chaos/">Borderline Chaos (1.9)</a>.  <br />It validates in <a class="footerLink" href="http://validator.w3.org/check/referer">XHTML</a> and <a class="footerLink" href="http://jigsaw.w3.org/css-validator/check/referer">CSS</a> minus plugins.
<br />

<a class="footerLink" href="http://www.managedtasks.com/wpthemes/blog">WordPress 1.5 Themes</a> is &copy; the Author. 


<br /><br />

</div>



</div>


</div>
</body>

</html>
