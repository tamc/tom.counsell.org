<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Excel to Latex table convertor</title>
  <link rel="stylesheet" href="/index.css">
</head>
<body>
  <header>
    <h1>Excel to Latex table convertor</h1>
  </header>
  <p>This is a quick script I hacked up to help doing tables in latex. Written for OSX 10.4 and your latex must use the longtable package.</p>
<p>To use:</p>
<ol>
<li>Copy the excel table you want to convert</li>
<li>Run this code (excel2latex.rb), it will place the latex in the clipboard</li>
<li>Paste into your latex document</li>
</ol>
<pre><code>#!/usr/bin/ruby
# (c) 2005 Tom Counsell tom@counsell.org
# Licenced under the GPL
#
# Converts excel tables into latex tables
#
# Requires Mac OSX 10.4, although could be adapted for other platoforms
#
# To use, copy the excel table you want to convert to the clipboard
# Run this code
# The latex code will be in the clipboard ready to paste
#
# Let me know of any bugfixes or suggestions

require &#39;csv&#39;

def escape_latex( string )
    string.gsub( %r{([&amp;$#%])} ) { &#39;\\&#39; + $1 }
end

text = `pbpaste`
lines = text.split(&quot;\r&quot;)
lines = lines.map { |line| line.split(&quot;\t&quot;) }
columns = lines.map { |line| line.size }.max
header = lines.shift

pbcopy = IO.popen(&#39;pbcopy&#39;,&#39;w+&#39;)

pbcopy.puts &quot;\\begin{center}&quot; 
pbcopy.puts &quot;\\begin{longtable}{#{&#39;l &#39;*columns}}&quot; 
pbcopy.puts header.map{ |entry| escape_latex entry }.join(&#39; &amp; &#39;)+&#39; \\\\&#39;
pbcopy.puts &quot;\\endfirsthead&quot; 
pbcopy.puts header.map{ |entry| escape_latex entry }.join(&#39; &amp; &#39;)+&#39; \\\\&#39;
pbcopy.puts &quot;\\endhead&quot; 
pbcopy.puts &quot;\\multicolumn{#{columns}}{r}{{Continued\\ldots}} \\&quot; 
pbcopy.puts &quot;\\endfoot&quot; 
pbcopy.puts &quot;\\hline&quot; 
pbcopy.puts &quot;\\endlastfoot&quot; 
pbcopy.puts
lines.each do |row| 
    pbcopy.puts row.map{ |entry| escape_latex entry }.join(&#39; &amp; &#39;)+&#39; \\\\&#39; 
end
pbcopy.puts
pbcopy.puts &quot;\\end{longtable}&quot; 
pbcopy.puts &quot;\\end{center}&quot; 
pbcopy.close_write
puts pbcopy.gets || &quot;Ok. In clipboard&quot;
</code></pre>

</body>
</html>
