<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Excel to Latex table convertor</title>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="screen">
		@import url( ../Static/style.css );
	</style>
	<link rel='alternate' type='application/rss+xml' title='RSS' href='http://tom.counsell.org/rss/ExcelToLatexTableConvertor' />
	<script src='http://tom.counsell.org/Static/newpage.js' type='text/javascript'></script>
		
</head>

<body onkeypress='hotkey(event,"http://tom.counsell.org/edit/");'>
<div id="wrapper">
	<div id="masthead">
		<div id="blogtitle" >
			Excel to Latex table convertor
		</div>
	</div>
	
	<div id="insideWrapper">
	
		<div id="sidebar">
			<div id="sidebox">
				<div class="title"><a href="../index.html" title="Tom Counsell's Soks Wiki">Tom Counsell's Soks Wiki</a></div>
			</div>
			<br />
	
			<div id="sidebox1">
				<div class="title">Key Pages</div>
				
				<a href='../index.html' class='automatic'>Home Page</a> <br/>
<a href='../view/SiteIndex.html' class='automatic'>Site Index</a> <br/>
<a href='../view/RecentChangesToThisSite.html' class=''>Recent Changes</a> <br/>
			</div>
			<br />

			<div id="sidebox4">
				<form style="padding: 0px; margin-top: 0px; margin-bottom: 0px;" id="searchform" method="get" action="http://tom.counsell.org/find/ExcelToLatexTableConvertor">
					<div class="title">Search:</div>
					<p style="padding: 0px; margin-top: 0px; margin-bottom: 0px;">
						<input type="text" class="input" name="regex" id="search" size="15" />
						<input name="submit" type="submit" tabindex="5" value="GO" />
					</p>
				</form>
			</div>
			<br />
			
			<div id='adbox'>
				<div class='title'>Adverts</div>
				<script type="text/javascript"><!--
				google_ad_client = "pub-1825629230893907";
				google_ad_width = 120;
				google_ad_height = 90;
				google_ad_format = "120x90_0ads_al";
				google_ad_channel = "";
				google_color_border = "000000";
				google_color_bg = "000000";
				google_color_link = "FFFFFF";
				google_color_text = "CCCCCC";
				google_color_url = "999999";
				//-->
				</script>
				<script type="text/javascript"
				  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
				  </script>
<p>
</p>
			</div>
<br/>			
			<div id="sidebox2">
				<div class="title">Backlinks</div>
				
					
					
					
							
								<a href='../view/Programming.html'>Programming</a><br/>
							
					
				
			</div>
			<br />
	
			<div id="sidebox3">
				<div class="title">Other Pages</div>
				<a href='../view/History.html' class='automatic'>History</a> <br/>
<a href='../view/Phd.html' class='automatic'>PhD</a> <br/>
<a href='../view/StuffIDoAroundTheDepartment.html' class=''>Department work</a> <br/>
<a href='../view/CollegeWork.html' class='automatic'>College work</a> <br/>
<a href='../view/Programming.html' class='automatic'>Programming</a> <br/>
			</div>
			<br />
			

	
			<div id="sidebox5">
				<div class="title">Links</div>
				<a href='http://tom.counsell.org/edit/TypeATitleHere'>Add a new page</a><br/>
				<a href='http://tom.counsell.org/edit/PictureOfTypeATitleHere'>Upload a new picture</a><br/>
				<a href='http://tom.counsell.org/edit/AttachedTypeATitleHere'>Upload a new file</a><br/>
			</div>
			<br />
	
			<div id="sidebox6">
				<div class="title"><a href='http://www.soks.org'>Soks</a> Powered</div>
				<a href='http://www.soks.org'>Soks</a> is a wiki written in ruby
			</div>  
			<br />
	</div>
	
	<div id="contentwrapper">
		<div id="content">
			<br />
			<div class="post">
			<span class='pagename'><a href='http://tom.counsell.org/meta/ExcelToLatexTableConvertor'>Excel to Latex table convertor</a> </span>



<h1>Revisions made by tamc up to 15:06 Wed 27 Jul 2005</h1>

<p>Note, if you wish to edit or undo these revisions, please follow the links from <a href='http://tom.counsell.org/edit/ExcelToLatexTableConvertor'>here</a>. You cannot do it from here, becuase someone may have edited the page more recently and because you may need a password to edit the page.</p>


	
	
	<div class="undochange">
		<p>15:06 Wed 27 Jul 2005</p>
		<ol>	
		
				
						<li><del>45. pbcopy.puts "\\multicolumn{#{columns}}{r}{{Continued\ldots}} \\"</del></li>
					
				
						<li>45. pbcopy.puts "\\multicolumn{#{columns}}{r}{{Continued\\ldots}} \\"</li>
					
				
					
		</ol>
	</div>		

	
	
	<div class="undochange">
		<p>07:47 Tue 26 Jul 2005</p>
		<ol>	
		
				
						<li><del>37. pbpaste = IO.popen('pbcopy','w+')</del></li>
					
				
						<li>37. pbcopy = IO.popen('pbcopy','w+')</li>
					
				
		
				
						<li><del>39. pbpaste.puts "\\begin{center}"</del></li>
					
				
						<li><del>40. pbpaste.puts "\\begin{longtable}{#{'l '*columns}}"</del></li>
					
				
						<li><del>41. pbpaste.puts header.map{ |entry| escape_latex entry }.join(' & ')+' \\\\'</del></li>
					
				
						<li><del>42. pbpaste.puts "\\endfirsthead"</del></li>
					
				
						<li><del>43. pbpaste.puts header.map{ |entry| escape_latex entry }.join(' & ')+' \\\\'</del></li>
					
				
						<li><del>44. pbpaste.puts "\\endhead"</del></li>
					
				
						<li><del>45. pbpaste.puts "\\multicolumn{#{columns}}{r}{{Continued\ldots}} \\"</del></li>
					
				
						<li><del>46. pbpaste.puts "\\endfoot"</del></li>
					
				
						<li><del>47. pbpaste.puts "\\hline"</del></li>
					
				
						<li><del>48. pbpaste.puts "\\endlastfoot"</del></li>
					
				
						<li><del>49. pbpaste.puts</del></li>
					
				
						<li>39. pbcopy.puts "\\begin{center}"</li>
					
				
						<li>40. pbcopy.puts "\\begin{longtable}{#{'l '*columns}}"</li>
					
				
						<li>41. pbcopy.puts header.map{ |entry| escape_latex entry }.join(' & ')+' \\\\'</li>
					
				
						<li>42. pbcopy.puts "\\endfirsthead"</li>
					
				
						<li>43. pbcopy.puts header.map{ |entry| escape_latex entry }.join(' & ')+' \\\\'</li>
					
				
						<li>44. pbcopy.puts "\\endhead"</li>
					
				
						<li>45. pbcopy.puts "\\multicolumn{#{columns}}{r}{{Continued\ldots}} \\"</li>
					
				
						<li>46. pbcopy.puts "\\endfoot"</li>
					
				
						<li>47. pbcopy.puts "\\hline"</li>
					
				
						<li>48. pbcopy.puts "\\endlastfoot"</li>
					
				
						<li>49. pbcopy.puts</li>
					
				
		
				
						<li><del>51. 	pbpaste.puts row.map{ |entry| escape_latex entry }.join(' & ')+' \\\\' </del></li>
					
				
						<li>51. 	pbcopy.puts row.map{ |entry| escape_latex entry }.join(' & ')+' \\\\' </li>
					
				
		
				
						<li><del>53. pbpaste.puts</del></li>
					
				
						<li><del>54. pbpaste.puts "\\end{longtable}"</del></li>
					
				
						<li><del>55. pbpaste.puts "\\end{center}"</del></li>
					
				
						<li><del>56. pbpaste.close_write</del></li>
					
				
						<li><del>57. puts pbpaste.gets || "Ok. In clipboard"</del></li>
					
				
						<li>53. pbcopy.puts</li>
					
				
						<li>54. pbcopy.puts "\\end{longtable}"</li>
					
				
						<li>55. pbcopy.puts "\\end{center}"</li>
					
				
						<li>56. pbcopy.close_write</li>
					
				
						<li>57. puts pbcopy.gets || "Ok. In clipboard"</li>
					
				
					
		</ol>
	</div>		

	
	
	<div class="undochange">
		<p>07:42 Tue 26 Jul 2005</p>
		<ol>	
		
				
						<li>0. h1. Excel to Latex table convertor</li>
					
				
						<li>1. </li>
					
				
						<li>2. This is a quick script I hacked up to help doing tables in latex.  Written for OSX 10.4 and your latex must use the longtable package.</li>
					
				
						<li>3. </li>
					
				
						<li>4. To use:</li>
					
				
						<li>5. # Copy the excel table you want to convert</li>
					
				
						<li>6. # Run this code (excel2latex.rb), it will place the latex in the clipboard</li>
					
				
						<li>7. # Paste into your latex document</li>
					
				
						<li>8. </li>
					
				
						<li>9. &lt;pre&gt;</li>
					
				
						<li>10. &lt;code&gt;</li>
					
				
						<li>11. #!/usr/bin/ruby</li>
					
				
						<li>12. # (c) 2005 Tom Counsell tom@counsell.org</li>
					
				
						<li>13. # Licenced under the GPL</li>
					
				
						<li>14. #</li>
					
				
						<li>15. # Converts excel tables into latex tables</li>
					
				
						<li>16. #</li>
					
				
						<li>17. # Requires Mac OSX 10.4, although could be adapted for other platoforms</li>
					
				
						<li>18. #</li>
					
				
						<li>19. # To use, copy the excel table you want to convert to the clipboard</li>
					
				
						<li>20. # Run this code</li>
					
				
						<li>21. # The latex code will be in the clipboard ready to paste</li>
					
				
						<li>22. #</li>
					
				
						<li>23. # Let me know of any bugfixes or suggestions</li>
					
				
						<li>24. </li>
					
				
						<li>25. require 'csv'</li>
					
				
						<li>26. </li>
					
				
						<li>27. def escape_latex( string )</li>
					
				
						<li>28. 	string.gsub( %r{([&$#%])} ) { '\\' + $1 }</li>
					
				
						<li>29. end</li>
					
				
						<li>30. </li>
					
				
						<li>31. text = `pbpaste`</li>
					
				
						<li>32. lines = text.split("\r")</li>
					
				
						<li>33. lines = lines.map { |line| line.split("\t") }</li>
					
				
						<li>34. columns = lines.map { |line| line.size }.max</li>
					
				
						<li>35. header = lines.shift</li>
					
				
						<li>36. </li>
					
				
						<li>37. pbpaste = IO.popen('pbcopy','w+')</li>
					
				
						<li>38. </li>
					
				
						<li>39. pbpaste.puts "\\begin{center}"</li>
					
				
						<li>40. pbpaste.puts "\\begin{longtable}{#{'l '*columns}}"</li>
					
				
						<li>41. pbpaste.puts header.map{ |entry| escape_latex entry }.join(' & ')+' \\\\'</li>
					
				
						<li>42. pbpaste.puts "\\endfirsthead"</li>
					
				
						<li>43. pbpaste.puts header.map{ |entry| escape_latex entry }.join(' & ')+' \\\\'</li>
					
				
						<li>44. pbpaste.puts "\\endhead"</li>
					
				
						<li>45. pbpaste.puts "\\multicolumn{#{columns}}{r}{{Continued\ldots}} \\"</li>
					
				
						<li>46. pbpaste.puts "\\endfoot"</li>
					
				
						<li>47. pbpaste.puts "\\hline"</li>
					
				
						<li>48. pbpaste.puts "\\endlastfoot"</li>
					
				
						<li>49. pbpaste.puts</li>
					
				
						<li>50. lines.each do |row| </li>
					
				
						<li>51. 	pbpaste.puts row.map{ |entry| escape_latex entry }.join(' & ')+' \\\\' </li>
					
				
						<li>52. end</li>
					
				
						<li>53. pbpaste.puts</li>
					
				
						<li>54. pbpaste.puts "\\end{longtable}"</li>
					
				
						<li>55. pbpaste.puts "\\end{center}"</li>
					
				
						<li>56. pbpaste.close_write</li>
					
				
						<li>57. puts pbpaste.gets || "Ok. In clipboard"</li>
					
				
						<li>58. &lt;/code&gt;</li>
					
				
						<li>59. &lt;/pre&gt;</li>
					
				
					
		</ol>
	</div>		


<div class='command'>
	<a href='../view/ExcelToLatexTableConvertor.html' accesskey="V" >View</a>, <a href='http://tom.counsell.org/edit/ExcelToLatexTableConvertor' accesskey="E" >Edit</a> or <a href='../revisions/ExcelToLatexTableConvertor.html' accesskey="R" >see all changes to</a> this page.
</div>
			<br />
		</div>
		<br />
	</div>
</div>



<div id="footer">

 <br />From an original theme on <a class="footerLink" href='http://wordpress.org' title='Proudly powered by WordPress, state-of-the-art semantic personal publishing platform'>WordPress 1.5</a>. <br />

This theme started out as <a class="footerLink" href="http://www.thoughtmechanics.com/blog/templates">Benevolence</a><br /> and ended up as  <a class="footerLink" href="http://theloo.org/2005/03/06/borderline-chaos/">Borderline Chaos (1.9)</a>.  <br />It validates in <a class="footerLink" href="http://validator.w3.org/check/referer">XHTML</a> and <a class="footerLink" href="http://jigsaw.w3.org/css-validator/check/referer">CSS</a> minus plugins.
<br />

<a class="footerLink" href="http://www.managedtasks.com/wpthemes/blog">WordPress 1.5 Themes</a> is &copy; the Author. 


<br /><br />

</div>



</div>


</div>
</body>

</html>
